# Клиент ФГИС Аршин
Программа предназначена для выгрузки данных о поверках из [ФГИС "Аршин"](https://fgis.gost.ru/fundmetrology/cm/) и формирования XLSX-файла (Excel), содержащего сведения о поверяемых средствах измерения. Используется [внешний публичный интерфейс](https://fgis.gost.ru/fundmetrology/cm/docs/1541318) (REST API) ФГИС "Аршин", что позволяет упросить процесс выгрузки данных.

![Изображение 2](https://github.com/tomin-vlad/FGIS_Arshin/blob/master/screen1.png)
![Изображение 1](https://github.com/tomin-vlad/FGIS_Arshin/blob/master/screen2.png)

## Установка
1. Скачайте в разделе Releases на GitHub последнюю версию программы, упакованную в исполняемый [EXE-файл "FGIS_Arshin.zip"](https://github.com/tomin-vlad/FGIS_Arshin/releases/latest).
2. Распакуйте скачанный ZIP-архив в удобную директорию на вашем ПК.
3. Запустите исполняемый файл "FGIS_Arshin.exe".

*Примечание: Для сохранения пользовательских настроек программа создает файл "user.config" в директории "`C:\Users\{Имя пользователя}\AppData\Local\FGIS_Arshin\FGIS_Arshin.exe_{ID программы}\{Версия программы}`".*

## Использование
Алгоритм работы с программой сводится к выполнению следующей последовательности действий:
1. Настройка параметров на вкладке "Параметры":
    - "**Сортировка**" - - выбор, по какому полю в XLSX-файле будут отсортрованы записи. Можно сортировать как в прямом, так и в обратном порядке (с помощью соответствующей галочки).
    - "**Кол-во в ответе**" - сколько записей будет запрашиваться при каждом обращении к API ФГИС "Аршин". Диапазон поля - от 1 до 100 записей.
    - "**Пауза запроса**" - пауза, которую будет выдерживать программа перед каждым запросом к API ФГИС "Аршин". Диапазон поля - от 500 до 5000 мс (от 0,5 до 5 сек). Данное техническое ограничение продиктовано требованиями REST API ФГИС "Аршин" в части ограничения частоты обращений к внешнему публичному интерфейсу. При слишком частых запросах вы можете получить блокировку со стороны Росстандарта, а при слишком редких - значительно возрастет время выполнения программы.
    - "**Повторять запрос**" - кол-во повторов запроса, которые попытается сделать программа при получении ответа с ошибкой от API ФГИС "Аршин". Диапазон поля - от 1 до 100 запросов.
    - "**Выгружаемые поля**" - можно выбрать, какие именно поля записей вы хотите видеть в XLSX-файле. Должно быть выбрано как минимум одно поле.
    - "**Директория выгрузки**" - директория на вашем ПК, куда будет сохранен XLSX-файл с результатами выгрузки. По умолчанию это директория "`C:\Users\{Имя пользователя}\Documents`".
2. Настройка параметров на вкладке "Фильтр":
    - "**Год**" - год поверки, по которому будет сделана выгрузка (применяется установкой соответствующей галочки). Если выгрузка идет с использованием даты поверки, то не применяется.
    - "**Организация-поверитель**" - наименование организации-поверителя.
    - "**Рег.номер типа СИ**" - регистрационный номер типа СИ.
    - "**Наименование типа СИ**" - наименование типа СИ.
    - "**Тип СИ**" - обозначение типа СИ.
    - "**Модификация СИ**" - модификация СИ.
    - "**Зав №/цифр-бук.обозн.**" - заводской/серийный номер/буквенно-цифровое обозначение.
    - "**Дата поверки**" - дата поверки СИ (начальная и конечная дата применяются установкой соответствующей галочки).
    - "**Действительна до**" - дата, до которой действительна поверка СИ (начальная и конечная дата применяются установкой соответствующей галочки).
    - "**Номер свидет./извещ.**" - номер свидетельства/извещения/выписки.
    - "**Номер наклейки**" - номер наклейки.
    - "**Пригодность**" - пригодность СИ.

*Примечание: установкой галочки "**Точно**" напротив соответствуюшего поля можно задать "жесткий" поиск, когда значение поля будет искаться по **точному** совпадению. В ином случае происходит "мягкий" поиск, когда допускается просто содержание значения поля в строке.*

3. Нажатие кнопки "Запустить". Процесс выполнения в процентах отображается на прогресс-баре под кнопкой.
4. По окончанию выгрузки, если процесс завершен успешно, появляется всплывающее уведомление о кол-ве выгруженных записей и пути к результирующему XLSX-файлу с выгрузкой. При клике на уведомление открывается XLSX-файл с выгрузкой.
5. В любом ином случае, если процесс выгрузки не завершился успехом, будет показано окно с описанием возникшей ошибки.

*Примечание: В большинстве случаев работа программы невозможна при активном подключении через VPN. Перед использованием программы необходимо отключить VPN. Данная техническая особенность обусловлена ограничениями со стороны Росстандарта в части доступа к API ФГИС «Аршин» с зарубежных IP-адресов.*

## Лицензия
Данная программа относится к свободному программному обеспечению и распространяется под лицензией MIT License. Подробную информацию можно найти в файле [LICENSE](https://github.com/tomin-vlad/FGIS_Arshin/blob/master/LICENSE).